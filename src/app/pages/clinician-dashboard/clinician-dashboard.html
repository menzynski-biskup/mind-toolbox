<div class="page">
  <header class="page-header">
    <div>
      <h2>Clinician Dashboard</h2>
      <p>Manage patients, clinical assessments, and reports.</p>
    </div>
    <div>
      <button type="button" (click)="loadPatients()" [disabled]="loading()">
        Reload patients
      </button>
    </div>
  </header>

  <section class="section">
    <h3>New patient</h3>
    <form class="patient-form" [formGroup]="addPatientForm" (ngSubmit)="addPatient()">
      <input type="text" placeholder="Name" formControlName="name" required />
      <input type="date" placeholder="Date of birth" formControlName="dateBirth" />
      <button type="submit" [disabled]="addPatientForm.invalid || loading()">Add</button>
    </form>
  </section>

<section class="section section--patients">
  <h3>Patients</h3>

  @if (loading()) {
    <p>Loading…</p>
  }

  @if (error()) {
    <p role="alert">{{ error() }}</p>
  }

  @if (showEmptyState()) {
    <p>No patients yet.</p>
  }

  @if (hasPatients()) {
    <table class="data-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Date of birth</th>
          <th>Sex</th>
          <th>Last assessment</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        @for (p of patients(); track p.id) {
          <tr>
            <td>{{ p.name }}</td>
            <td>{{ p.date_birth ?? '—' }}</td>
            <td>{{ p.sex ?? '—' }}</td>
            <td>{{ p.last_assessment ?? '—' }}</td>
            <td>{{ p.status ?? '—' }}</td>
          </tr>
        }
      </tbody>
    </table>
  }
</section>

  <footer class="dashboard-footer">
    <button routerLink="/login">Back to login</button>
  </footer>
</div>